CREATE DATABASE COMPANY;
USE COMPANY;
CREATE TABLE EMPLOYEE_N(
ID INT PRIMARY KEY,
F_NAME VARCHAR(255),
L_NAME VARCHAR(255),
AGE INT,
EMAIL VARCHAR(255),
PHONE INT,
CITY VARCHAR(255)
);

INSERT INTO EMPLOYEE_N 
VALUES (1, 'DILIP', 'PAWAR', 21, 'dilippawar@email.com', 856, 'Mumbai'),
(2, 'DINESH', 'PATIL', 26, 'dineshpatil@email.com', 295, 'Delhi') ,
(3, 'DIPAK', 'PATOLE', 25, 'dipakpatole@email.com', 375, 'Banglore') ,
(4, 'DINKAR', 'PETKAR', 30, 'dinkarpetkar@email.com', 215, 'Pune') ,
(5, 'DINANK', 'PODAR', 28, 'dinankpodar@email.com', 349, 'Nagpur'); 

SELECT * FROM EMPLOYEE_N;

CREATE TABLE PROJECT (
ID INT PRIMARY KEY,
EMP_ID INT,
FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE_N(ID),
PRONAME VARCHAR(255),
STARTDATE DATE,
CLIENTID INT,
FOREIGN KEY (CLIENTID) REFERENCES CLIENT(ID)
);

INSERT INTO PROJECT 
VALUES (01, 1, 'A', '2023-03-11', 003),
 (02, 2, 'B', '2023-02-21', 001),
 (03, 3, 'C', '2023-03-22', 005),
 (04, 4, 'D', '2023-04-23', 002),
 (05, 5, 'E', '2023-05-24', 004);
 
 SELECT * FROM PROJECT;
 
 CREATE TABLE CLIENT (
ID INT PRIMARY KEY,
FIRST_NAME VARCHAR(255),
LAST_NAME VARCHAR(255),
AGE_C INT,
MAIL_ID VARCHAR(255),
PHONE_NO INT,
CITY_C VARCHAR(255), 
EMPL_ID INT,
FOREIGN KEY (EMPL_ID) REFERENCES EMPLOYEE_N(ID)
);

INSERT INTO CLIENT
VALUES (001, 'MONA', 'CHOHAN', 23, 'monachohan@email.com', 524, 'Banglore', 3),
(002, 'SONA', 'BHAGAT', 25, 'sonabhagat@email.com', 123, 'Banglore', 3),
(003, 'TONA', 'SHARMA', 30, 'tonasharma@email.com', 546, 'Delhi', 1),
(004, 'RONA', 'VERMA', 20, 'ronaverma@email.com', 315, 'RANCHI', 5),
(005, 'LONA', 'MISHRA', 27, 'lonamishra@email.com', 426, 'BARELI', 2);

SELECT * FROM CLIENT;

SELECT E.ID, E.F_NAME, E.L_NAME, P.ID, P.PRONAME FROM EMPLOYEE_N AS E
INNER JOIN PROJECT AS P ON E.ID = P.EMP_ID;

SELECT E.ID, E.F_NAME, E.L_NAME, P.ID, P.PRONAME FROM EMPLOYEE_N AS E,
PROJECT AS P WHERE E.ID = P.EMP_ID;

SELECT * FROM EMPLOYEE_N AS E
INNER JOIN PROJECT AS P ON E.ID = P.EMP_ID;

SELECT E.ID, E.EMAIL, E.PHONE, C.FIRST_NAME, C.LAST_NAME FROM EMPLOYEE_N AS E 
INNER JOIN CLIENT AS C ON E.ID = C.EMPL_ID WHERE E.CITY = 'Nagpur' AND C.CITY_C = 'RANCHI';

SELECT P.ID, P.PRONAME, E.F_NAME, E.L_NAME, E.EMAIL FROM EMPLOYEE_N AS E
RIGHT JOIN PROJECT AS P ON E.ID = P.EMP_ID; 

SELECT E.ID, E.F_NAME, E.L_NAME, P.ID, P.PRONAME FROM EMPLOYEE_N AS E
CROSS JOIN PROJECT AS P; 

SELECT * FROM EMPLOYEE_N WHERE AGE IN (SELECT AGE FROM EMPLOYEE_N WHERE AGE > 18); 

SELECT * FROM EMPLOYEE_N WHERE ID IN (
SELECT EMP_ID FROM PROJECT  GROUP BY EMP_ID HAVING COUNT(EMP_ID)>1
); 

SELECT * from EMPLOYEE_N WHERE AGE > (SELECT AVG(AGE) FROM EMPLOYEE_N);
(SELECT AVG(AGE) FROM EMPLOYEE_N);

SELECT MAX(AGE) FROM (SELECT * FROM EMPLOYEE_N WHERE F_NAME LIKE '%D%') AS tp; 

SELECT * 
FROM EMPLOYEE_N E1
WHERE 3 = (
SELECT COUNT(E2.AGE)
FROM EMPLOYEE_N E2
WHERE E2.AGE >= E1.AGE
);

CREATE VIEW CUSTOM_VIEW AS SELECT F_NAME , AGE FROM EMPLOYEE_N;
SELECT * FROM CUSTOM_VIEW;

ALTER VIEW CUSTOM_VIEW  AS SELECT F_NAME , AGE, L_NAME FROM EMPLOYEE_N;
DROP VIEW IF EXISTS CUSTOM_VIEW;